import matplotlib.pyplot as plt import cv2 def svd_from_eigendecomp(A: np.ndarray, eps: float = 1e-12): AtA = A.T @ A lam, V = np.linalg.eigh(AtA) sigma = np.sqrt(np.clip(lam, 0, None)) idx = np.argsort(sigma)[::-1] sigma = sigma[idx] V = V[:, idx] r = int(np.sum(sigma > eps)) sigma_r = sigma[:r] V_r = V[:, :r] U_r = A @ V_r U_r = U_r / sigma_r[None, :] U_r = U_r / np.linalg.norm(U_r, axis=0, keepdims=True) return U_r, sigma_r, V_r def reconstruct_rank_k(U_r, sigma_r, V_r, k: int): k = int(min(k, len(sigma_r))) if k == 0: return np.zeros((U_r.shape[0], V_r.shape[0]), dtype=np.float64) Ak = np.zeros((U_r.shape[0], V_r.shape[0]), dtype=np.float64) for i in range(k): ui = U_r[:, i][:, None] vi = V_r[:, i][None, :] Ak += sigma_r[i] * (ui @ vi) return Ak img = cv2.imread("images.jpg") if img is None: raise FileNotFoundError img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB).astype(np.float64) k = 2 compressed = np.zeros_like(img, dtype=np.float64) for c in range(3): A = img[:, :, c] U_r, sigma_r, V_r = svd_from_eigendecomp(A) Ak = reconstruct_rank_k(U_r, sigma_r, V_r, k) compressed[:, :, c] = Ak compressed = np.clip(compressed, 0, 255).astype(np.uint8) plt.figure(figsize=(10,5)) plt.subplot(1,2,1); plt.title("Original"); plt.imshow(img.astype(np.uint8)); plt.axis("off") plt.subplot(1,2,2); plt.title(f"Compressed (k={k})"); plt.imshow(compressed); plt.axis("off") plt.tight_layout() plt.show()